<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>FOUDEK â€“ ThÃ©orie et calculs</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  padding: 0;
  background: #0e0f14;
  color: #e6e7eb;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
               Roboto, Oxygen, Ubuntu, Cantarell, "Inter", sans-serif;
  line-height: 1.6;
}

.container {
  max-width: 900px;
  margin: auto;
  padding: 40px 20px;
}

h1, h2, h3 {
  text-align: center;
  font-weight: 700;
}

h1 {
  font-size: 30px;
  margin-bottom: 40px;
}

h2 {
  font-size: 24px;
  margin: 50px 0 20px;
}

p {
  margin: 16px 0;
  font-size: 16px;
}

ul {
  margin: 16px 0 16px 20px;
}

li {
  margin: 8px 0;
}

.separator {
  height: 1px;
  background: #2a2c36;
  margin: 50px 0;
}

.formula {
  background: #1a1c25;
  border-radius: 8px;
  padding: 14px 18px;
  font-family: "JetBrains Mono", Consolas, monospace;
  font-size: 15px;
  overflow-x: auto;
  margin: 20px 0;
  text-align: center;
}

.cards {
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
  justify-content: center;
  margin-top: 40px;
}

.card {
  background: #0e0f14;
  border: 1px solid #2a2c36;
  border-radius: 14px;
  padding: 20px;
  width: 300px;
}

.card.blue {
  box-shadow: 0 0 18px rgba(37, 99, 235, 0.35);
}

.card.red {
  box-shadow: 0 0 18px rgba(220, 38, 38, 0.35);
}

label {
  display: block;
  margin-top: 12px;
  font-size: 14px;
}

input {
  width: 100%;
  margin-top: 6px;
  padding: 8px;
  background: #0e0f14;
  border: 1px solid #3a3d4d;
  border-radius: 6px;
  color: #e6e7eb;
}

button {
  width: 100%;
  margin-top: 16px;
  padding: 10px;
  border: none;
  border-radius: 6px;
  background: #2563eb;
  color: white;
  font-weight: bold;
  cursor: pointer;
}

.result {
  margin-top: 15px;
  padding: 10px;
  border-radius: 999px;
  text-align: center;
  font-weight: bold;
  opacity: 0.35;
  transition: opacity 0.3s, box-shadow 0.3s;
}

.result.blue {
  background: #1d4ed8;
}

.result.red {
  background: #dc2626;
}

.result.active {
  opacity: 1;
  box-shadow: 0 0 20px rgba(255,255,255,0.25);
}
</style>
</head>

<body>
<div class="container">

<h1>FOUDEK â€“ ThÃ©orie et probabilitÃ© hors intervalle</h1>

<h2>Pourquoi il nâ€™y a jamais plus de 1 loup sur 4</h2>

<p>
Dans la technique de FOUDEK, on considÃ¨re uniquement les cas oÃ¹ un
intervalle de 4 joueurs contient 0 ou 1 loup.
</p>

<p>
La raison est purement probabiliste : si un intervalle contenait
2 loups sur 4, alors la probabilitÃ© quâ€™un joueur innocent vote un
innocent serait plus Ã©levÃ©e que la probabilitÃ© de voter un loup.
</p>

<p>
Autrement dit, dÃ©passer 1/4 rend la dÃ©cision irrationnelle pour
un innocent cherchant Ã  optimiser son vote. Ces mondes sont donc
exclus par construction dans la technique FOUDEK.
</p>

<div class="separator"></div>

<h2>DÃ©tail du calcul de la probabilitÃ© hors intervalle</h2>

<p>On note :</p>
<ul>
  <li><strong>I</strong> : nombre de joueurs dans lâ€™intervalle</li>
  <li><strong>R</strong> : nombre de joueurs hors intervalle</li>
  <li><strong>L</strong> : nombre de loups vivants</li>
  <li><strong>k</strong> : nombre de loups dans lâ€™intervalle</li>
</ul>

<div class="formula">
C(I, k) Ã— C(R, L âˆ’ k)
</div>

<div class="formula">
(L âˆ’ k) / R
</div>

<div class="separator"></div>

<h2>Ã‰quation universelle finale</h2>

<div class="formula">
P<sub>R</sub> =
Î£<sub>k = 0</sub><sup>1</sup>
(
C(I, k) Â· C(R, L âˆ’ k)
/
Î£<sub>i = 0</sub><sup>1</sup>
C(I, i) Â· C(R, L âˆ’ i)
)
Ã— (L âˆ’ k) / R
</div>

<div class="separator"></div>

<h2>Calcul de probabilitÃ©</h2>

<div class="cards">

<div class="card blue">
<h3>ðŸ”µ MÃ©thode FOUDEK</h3>
<label>Joueurs dans lâ€™intervalle</label>
<input id="I1" type="number">
<label>Joueurs hors intervalle</label>
<input id="R1" type="number">
<label>Loups vivants</label>
<input id="L1" type="number">
<button onclick="calcFoudek()">Calculer</button>
<div id="resF" class="result blue">â€”</div>
</div>

<div class="card red">
<h3>ðŸ”´ MÃ©thode classique</h3>
<label>Joueurs dans lâ€™intervalle</label>
<input id="I2" type="number">
<label>Joueurs hors intervalle</label>
<input id="R2" type="number">
<label>Loups vivants</label>
<input id="L2" type="number">
<button onclick="calcClassic()">Calculer</button>
<div id="resC" class="result red">â€”</div>
</div>

</div>

<!-- ================= ACTIVITÃ‰ INTERACTIVE ================= -->

<div class="separator"></div>

<h2>ActivitÃ© interactive â€“ Comparaison FOUDEK / Classique</h2>

<p>
Cette activitÃ© simule des votes et compare la probabilitÃ© quâ€™un joueur
hors intervalle soit loup selon les deux systÃ¨mes.
</p>

<div class="cards">

<div class="card blue">
<label>Nombre total de joueurs</label>
<input id="Tsim" type="number" value="8">

<label>Nombre de loups</label>
<input id="Lsim" type="number" value="2">

<label>Votes (ex : A>B,C>B)</label>
<input id="Vsim" type="text" placeholder="A>B,C>B">

<button onclick="runSimulation()">Simuler</button>
</div>

<div class="card red">
<div id="simF" class="result blue">FOUDEK : â€”</div>
<div id="simC" class="result red">Classique : â€”</div>

<div id="best"
     class="result active"
     style="background:#1a1c25;margin-top:20px;">
â€”
</div>
</div>

</div>

</div>

<script>
// Combinaisons
function C(n, k) {
  if (k < 0 || k > n) return 0;
  let r = 1;
  for (let i = 1; i <= k; i++) r *= (n - i + 1) / i;
  return r;
}

// FOUDEK (inchangÃ©)
function calcFoudek() {
  const I = +I1.value, R = +R1.value, L = +L1.value;
  let num = 0, den = 0;

  for (let k = 0; k <= 1; k++) {
    if (k > L || L - k > R) continue;
    const c = C(I, k) * C(R, L - k);
    den += c;
    num += c * ((L - k) / R);
  }

  resF.textContent = ((num / den) * 100).toFixed(1) + " %";
  resF.classList.add("active");
}

// Classique (inchangÃ©)
function calcClassic() {
  const I = +I2.value, R = +R2.value, L = +L2.value;
  resC.textContent = ((L / (I + R)) * 100).toFixed(1) + " %";
  resC.classList.add("active");
}

// ACTIVITÃ‰ INTERACTIVE
function runSimulation() {
  const T = +Tsim.value;
  const L = +Lsim.value;
  const votes = Vsim.value.split(",");

  const interval = new Set();
  votes.forEach(v => {
    const [a, b] = v.split(">");
    if (a && b) {
      interval.add(a.trim());
      interval.add(b.trim());
    }
  });

  const I = interval.size;
  const R = T - I;

  // FOUDEK
  let num = 0, den = 0;
  for (let k = 0; k <= 1; k++) {
    if (k > L || L - k > R) continue;
    const c = C(I, k) * C(R, L - k);
    den += c;
    num += c * ((L - k) / R);
  }
  const pF = (num / den) * 100;

  // Classique
  const pC = (L / T) * 100;

  simF.textContent = "FOUDEK : " + pF.toFixed(1) + " %";
  simC.textContent = "Classique : " + pC.toFixed(1) + " %";

  best.textContent =
    pF > pC
    ? "SystÃ¨me le plus rentable : FOUDEK"
    : "SystÃ¨me le plus rentable : Classique";
}
</script>

</body>
</html>