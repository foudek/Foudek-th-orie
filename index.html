<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>FOUDEK – Théorie et simulation</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  padding: 0;
  background: #0e0f14;
  color: #e6e7eb;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Inter", sans-serif;
}

.container {
  max-width: 900px;
  margin: auto;
  padding: 40px 20px;
}

h1, h2, h3 {
  text-align: center;
}

.separator {
  height: 1px;
  background: #2a2c36;
  margin: 50px 0;
}

.cards {
  display: flex;
  gap: 20px;
  justify-content: center;
  flex-wrap: wrap;
}

.card {
  background: #0e0f14;
  border: 1px solid #2a2c36;
  border-radius: 14px;
  padding: 20px;
  width: 300px;
}

.card.blue { box-shadow: 0 0 18px rgba(37,99,235,0.35); }
.card.red { box-shadow: 0 0 18px rgba(220,38,38,0.35); }

label {
  display: block;
  margin-top: 12px;
}

input {
  width: 100%;
  padding: 8px;
  margin-top: 6px;
  background: #0e0f14;
  border: 1px solid #3a3d4d;
  color: #e6e7eb;
  border-radius: 6px;
}

button {
  margin-top: 16px;
  padding: 10px;
  width: 100%;
  border: none;
  border-radius: 6px;
  background: #2563eb;
  color: white;
  font-weight: bold;
  cursor: pointer;
}

.result {
  margin-top: 15px;
  padding: 10px;
  border-radius: 999px;
  text-align: center;
  font-weight: bold;
  opacity: 0.4;
}

.result.active { opacity: 1; }
.result.blue { background: #1d4ed8; }
.result.red { background: #dc2626; }

/* Simulation visuelle */
.board {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 16px;
  margin-top: 30px;
}

.player {
  border: 1px solid #2a2c36;
  border-radius: 14px;
  padding: 14px;
  text-align: center;
  transition: 0.3s;
}

.player.you { border: 2px solid #22c55e; }

.player.interval {
  box-shadow: 0 0 20px rgba(37,99,235,0.6);
  transform: scale(1.05);
}

.controls {
  margin-top: 30px;
  text-align: center;
}

.controls input { width: 260px; }

.best {
  margin-top: 20px;
  padding: 12px;
  border-radius: 999px;
  background: #1a1c25;
  text-align: center;
  font-weight: bold;
}
</style>
</head>

<body>
<div class="container">

<h1>FOUDEK – Probabilité hors intervalle</h1>

<!-- Tableaux inchangés -->
<div class="cards">
  <div class="card blue">
    <h3>Méthode FOUDEK</h3>
    <label>Joueurs dans l’intervalle</label>
    <input id="I1" type="number">
    <label>Joueurs hors intervalle</label>
    <input id="R1" type="number">
    <label>Loups vivants</label>
    <input id="L1" type="number">
    <button onclick="calcFoudek()">Calculer</button>
    <div id="resF" class="result blue">—</div>
  </div>

  <div class="card red">
    <h3>Méthode Classique</h3>
    <label>Joueurs dans l’intervalle</label>
    <input id="I2" type="number">
    <label>Joueurs hors intervalle</label>
    <input id="R2" type="number">
    <label>Loups vivants</label>
    <input id="L2" type="number">
    <button onclick="calcClassic()">Calculer</button>
    <div id="resC" class="result red">—</div>
  </div>
</div>

<div class="separator"></div>

<h2>Simulation de partie</h2>

<div class="board">
  <div class="player you">Vous</div>
  <div class="player" data-id="A">Joueur A</div>
  <div class="player" data-id="B">Joueur B</div>
  <div class="player" data-id="C">Joueur C</div>
  <div class="player" data-id="D">Joueur D</div>
  <div class="player" data-id="E">Joueur E</div>
  <div class="player" data-id="F">Joueur F</div>
  <div class="player" data-id="G">Joueur G</div>
</div>

<div class="controls">
  <p>Votes observés (ex : A>B,C>B)</p>
  <input id="votes" placeholder="A>B,C>B">
  <br><br>
  <button onclick="simulate()">Simuler</button>
</div>

<div class="best" id="best">—</div>

</div>

<script>
// COMBINAISONS
function C(n, k) {
  if (k < 0 || k > n) return 0;
  var r = 1;
  for (var i = 1; i <= k; i++) r = r * (n - i + 1) / i;
  return r;
}

// FOUDEK
function calcFoudek() {
  var I = Number(document.getElementById("I1").value);
  var R = Number(document.getElementById("R1").value);
  var L = Number(document.getElementById("L1").value);

  var num = 0, den = 0;
  for (var k = 0; k <= 1; k++) {
    if (k > L || L - k > R) continue;
    var c = C(I, k) * C(R, L - k);
    den += c;
    num += c * ((L - k) / R);
  }

  document.getElementById("resF").textContent =
    ((num / den) * 100).toFixed(1) + " %";
  document.getElementById("resF").classList.add("active");
}

// CLASSIQUE
function calcClassic() {
  var I = Number(document.getElementById("I2").value);
  var R = Number(document.getElementById("R2").value);
  var L = Number(document.getElementById("L2").value);

  document.getElementById("resC").textContent =
    ((L / (I + R)) * 100).toFixed(1) + " %";
  document.getElementById("resC").classList.add("active");
}

// SIMULATION 100% COMPATIBLE
function simulate() {
  var voteInput = document.getElementById("votes").value;
  var interval = [];

  var players = document.getElementsByClassName("player");
  for (var i = 0; i < players.length; i++) {
    players[i].classList.remove("interval");
  }

  if (voteInput !== "") {
    var votes = voteInput.split(",");
    for (var j = 0; j < votes.length; j++) {
      var parts = votes[j].split(">");
      if (parts.length === 2) {
        var a = parts[0].trim();
        var b = parts[1].trim();
        if (interval.indexOf(a) === -1) interval.push(a);
        if (interval.indexOf(b) === -1) interval.push(b);
      }
    }
  }

  for (var k = 0; k < interval.length; k++) {
    var el = document.querySelector('.player[data-id="' + interval[k] + '"]');
    if (el) el.classList.add("interval");
  }

  document.getElementById("best").textContent =
    "Simulation effectuée — les probabilités restent celles calculées ci-dessus";
}
</script>

</body>
</html>