<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>FOUDEK ‚Äì Th√©orie et calculs</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body { margin:0; padding:0; background:#0e0f14; color:#e6e7eb;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Inter",sans-serif;
  line-height:1.6; }
.container { max-width:1200px; margin:auto; padding:40px 20px; }
h1,h2,h3{text-align:center; font-weight:700;}
h1{font-size:30px; margin-bottom:40px;}
h2{font-size:24px; margin:50px 0 20px;}
p{margin:16px 0; font-size:16px;}
ul{margin:16px 0 16px 20px;}
li{margin:8px 0;}
.separator{height:1px; background:#2a2c36; margin:50px 0;}
.formula{background:#1a1c25; border-radius:8px; padding:14px 18px;
  font-family:"JetBrains Mono",Consolas,monospace;font-size:15px;
  overflow-x:auto;margin:20px 0;text-align:center;}
.cards{display:flex; gap:20px; flex-wrap:wrap; justify-content:center; margin-top:40px;}
.card{background:#0e0f14; border:1px solid #2a2c36; border-radius:14px; padding:20px; width:300px;}
.card.blue{box-shadow:0 0 18px rgba(37, 99, 235, 0.35);}
.card.red{box-shadow:0 0 18px rgba(220, 38, 38, 0.35);}
label{display:block;margin-top:12px;font-size:14px;}
input,select{width:100%; margin-top:6px; padding:8px; background:#0e0f14; border:1px solid #3a3d4d; border-radius:6px; color:#e6e7eb;}
button{width:100%; margin-top:16px; padding:10px; border:none; border-radius:6px; background:#2563eb; color:white; font-weight:bold; cursor:pointer;}
.result{margin-top:10px; padding:10px; border-radius:999px; text-align:center; font-weight:bold; opacity:0.35; transition:opacity 0.3s, box-shadow 0.3s;}
.result.blue{background:#1d4ed8;}
.result.red{background:#dc2626;}
.result.active{opacity:1; box-shadow:0 0 20px rgba(255,255,255,0.25);}
.voteInfo{margin-top:5px; font-size:13px; color:#9ca3af;}
#simZone{display:flex; flex-wrap:wrap; gap:10px; margin-top:20px;}
</style>
</head>

<body>
<div class="container">

<h1>FOUDEK ‚Äì Th√©orie et probabilit√© hors intervalle</h1>

<h2>Pourquoi il n‚Äôy a jamais plus de 1 loup sur 4</h2>
<p>
Dans la technique de FOUDEK, on consid√®re uniquement les cas o√π un
intervalle de 4 joueurs contient 0 ou 1 loup.
</p>

<p>
La raison est purement probabiliste : si un intervalle contenait
2 loups sur 4, alors la probabilit√© qu‚Äôun joueur innocent vote un
innocent serait plus √©lev√©e que la probabilit√© de voter un loup.
</p>

<p>
Autrement dit, d√©passer 1/4 rend la d√©cision irrationnelle pour
un innocent cherchant √† optimiser son vote. Ces mondes sont donc
exclus par construction dans la technique FOUDEK.
</p>

<p>
La th√©orie FOUDEK correspond √† une situation o√π un joueur innocent,
souvent de mani√®re inconsciente, pense qu‚Äôil existe au moins un loup
hors de son intervalle imm√©diat. Cette intuition ne repose pas sur
un calcul explicite, mais sur la r√©p√©tition des comportements observ√©s
en partie r√©elle.
</p>

<p>
Lorsqu‚Äôun loup est pr√©sent dans un intervalle de 4 joueurs, les
innocents restants ont naturellement tendance √† voter √† l‚Äôext√©rieur
de cet intervalle, car leurs d√©saccords internes emp√™chent une
coordination stable contre un innocent pr√©cis.
</p>

<p>
√Ä l‚Äôinverse, si deux loups √©taient pr√©sents dans le m√™me intervalle,
leur capacit√© de coordination ferait m√©caniquement augmenter la
probabilit√© qu‚Äôun innocent de l‚Äôintervalle soit √©limin√©, ce qui
contredirait l‚Äôobjectif rationnel d‚Äôun vote optimis√© pour un innocent.
</p>

<p>
Les conversations entre joueurs permettent souvent de mettre en
√©vidence deux intervalles potentiels distincts, sans qu‚Äôil soit
n√©cessaire de conna√Ætre pr√©cis√©ment les r√¥les. Ces s√©parations
√©mergent naturellement du d√©bat et des prises de position.
</p>

<p>
Les triangles de vote constituent √©galement un indicateur cl√© :
par exemple, si le joueur A vote le joueur C, que le joueur C vote
le joueur D, et que le joueur D vote le joueur A, un cycle se forme.
Ce type de configuration montre qu‚Äôaucun groupe ne peut d√©passer un
tiers des joueurs sans cr√©er de contradictions dans la logique de vote
des innocents.
</p>

<p>
L‚Äôensemble de ces comportements ‚Äî votes, discussions, cycles et
s√©parations ‚Äî converge vers une m√™me conclusion : dans un intervalle
de 4 joueurs, il ne peut rationnellement y avoir plus d‚Äôun loup si
les votes sont effectu√©s par des joueurs cherchant √† maximiser leurs
chances d‚Äô√©liminer un loup. La r√©p√©tition de ce sch√©ma au fil de la partie
renforce la probabilit√© de voter hors intervalle de mani√®re fiable.
</p>

<div class="separator"></div>

<h2>D√©tail du calcul de la probabilit√© hors intervalle</h2>
<p>On note :</p>
<ul>
<li><strong>I</strong> : nombre de joueurs dans l‚Äôintervalle</li>
<li><strong>R</strong> : nombre de joueurs hors intervalle</li>
<li><strong>L</strong> : nombre de loups vivants</li>
<li><strong>k</strong> : nombre de loups dans l‚Äôintervalle</li>
</ul>

<div class="formula">C(I, k) √ó C(R, L ‚àí k)</div>
<div class="formula">(L ‚àí k) / R</div>

<div class="separator"></div>

<h2>√âquation universelle finale</h2>
<div class="formula">
P<sub>R</sub> =
Œ£<sub>k = 0</sub><sup>1</sup>
(
C(I, k) ¬∑ C(R, L ‚àí k)
/
Œ£<sub>i = 0</sub><sup>1</sup>
C(I, i) ¬∑ C(R, L ‚àí i)
)
√ó (L ‚àí k) / R
</div>

<div class="separator"></div>

<h2>Calcul de probabilit√©</h2>
<div class="cards">
<div class="card blue">
<h3>üîµ M√©thode FOUDEK</h3>
<label>Joueurs dans l‚Äôintervalle</label>
<input id="I1" type="number">
<label>Joueurs hors intervalle</label>
<input id="R1" type="number">
<label>Loups vivants</label>
<input id="L1" type="number">
<button onclick="calcFoudek()">Calculer</button>
<div id="resF" class="result blue">‚Äî</div>
</div>

<div class="card red">
<h3>üî¥ M√©thode classique</h3>
<label>Joueurs dans l‚Äôintervalle</label>
<input id="I2" type="number">
<label>Joueurs hors intervalle</label>
<input id="R2" type="number">
<label>Loups vivants</label>
<input id="L2" type="number">
<button onclick="calcClassic()">Calculer</button>
<div id="resC" class="result red">‚Äî</div>
</div>
</div>

<div class="separator"></div>

<h2>üé≠ Activit√© ‚Äì Probabilit√©s hors intervalle</h2>
<div class="card">
<label>Nombre total de joueurs</label>
<input id="simN" type="number" value="7" min="6">
<label>Nombre de loups vivants</label>
<input id="simL" type="number" value="2">
<button onclick="genSim()">G√©n√©rer les joueurs</button>
</div>

<div id="simZone"></div>

<div class="card" style="margin-top:30px;">
<h3>Votes</h3>
<label>Vote 1 - Joueur :</label>
<select id="vote1voter" onchange="updateSim()"></select>
<select id="vote1target" onchange="updateSim()"></select>
<label>Vote 2 - Joueur (optionnel) :</label>
<select id="vote2voter" onchange="updateSim()"></select>
<select id="vote2target" onchange="updateSim()"></select>
</div>

</div>

<script>
function C(n,k){if(k<0||k>n)return 0;let r=1;for(let i=1;i<=k;i++)r*=(n-i+1)/i;return r;}

function calcFoudek(){
  const I=+I1.value,R=+R1.value,L=+L1.value;
  let num=0,den=0;
  for(let k=0;k<=1;k++){if(k>L||L-k>R) continue; const c=C(I,k)*C(R,L-k); den+=c; num+=c*((L-k)/R);}
  const p=(num/den)*100;
  resF.textContent=p.toFixed(1)+" %"; resF.classList.add("active");
}

function calcClassic(){
  const I=+I2.value,R=+R2.value,L=+L2.value;
  let num=0,den=0;
  for(let k=0;k<=2;k++){if(k>L||L-k>R) continue; const c=C(I,k)*C(R,L-k); den+=c; num+=c*((L-k)/R);}
  const p=(den>0)? (num/den)*100 : 0;
  resC.textContent=p.toFixed(1)+" %"; resC.classList.add("active");
}

/* === ACTIVIT√â === */
function genSim(){
  const n=+simN.value,L=+simL.value;
  let html="", opts="";
  for(let i=1;i<=n;i++){
    html+=`<div class="card" id="card${i}" style="width:120px">
      <strong>Joueur ${i}</strong>
      <label><input type="checkbox" id="d${i}" onchange="updateSim()"/> Mort</label>
      <div class="result blue" id="pf${i}">FOUDEK : ‚Äî</div>
      <div class="result red" id="pc${i}">Classique : ‚Äî</div>
      <div class="voteInfo" id="voteInfo${i}"></div>
    </div>`;
    opts+=`<option value="${i}">Joueur ${i}</option>`;
  }
  vote1voter.innerHTML=opts; vote1target.innerHTML=opts;
  vote2voter.innerHTML=opts; vote2target.innerHTML=opts;
  simZone.innerHTML=html;
  updateSim();
}

function updateSim(){
  const n=+simN.value,L=+simL.value;
  const alive=[];
  for(let i=1;i<=n;i++){
    if(!document.getElementById("d"+i).checked) alive.push(i);
    document.getElementById("voteInfo"+i).textContent="";
    document.getElementById("pf"+i).textContent="FOUDEK : ‚Äî";
    document.getElementById("pc"+i).textContent="Classique : ‚Äî";
  }

  const votes=[];
  const v1v=+vote1voter.value,v1t=+vote1target.value;
  if(v1v&&v1t) votes.push({from:v1v,to:v1t});
  const v2v=+vote2voter.value,v2t=+vote2target.value;
  if(v2v&&v2t) votes.push({from:v2v,to:v2t});

  const inInterval=new Set();
  votes.forEach(v=>{
    let a=Math.min(v.from,v.to),b=Math.max(v.from,v.to);
    if(b-a+1>4) b=a+3;
    for(let i=a;i<=b;i++) inInterval.add(i);
  });

  const totalPlayers=alive.length;
  const totalOutside=totalPlayers-inInterval.size;

  alive.forEach(idx=>{
    if(inInterval.has(idx)) return;
    const R=totalOutside;
    const I=Math.min(4,totalPlayers-R);
    // FOUDEK
    let numF=0,denF=0;
    for(let k=0;k<=1;k++){
      if(k>L||L-k>R) continue;
      const c=C(I,k)*C(R,L-k);
      denF+=c; numF+=c*((L-k)/R);
    }
    const pf=(denF>0)? (numF/denF)*100 : 0;
    // Classique
    let numC=0,denC=0;
    for(let k=0;k<=2;k++){
      if(k>L||L-k>R) continue;
      const c=C(I,k)*C(R,L-k);
      denC+=c; numC+=c*((L-k)/R);
    }
    const pc=(denC>0)? (numC/denC)*100 : 0;
    document.getElementById("pf"+idx).textContent="FOUDEK : "+pf.toFixed(1)+" %";
    document.getElementById("pc"+idx).textContent="Classique : "+pc.toFixed(1)+" %";
  });

  votes.forEach(v=>{
    document.getElementById("voteInfo"+v.to).textContent=`Joueur ${v.from} vote pour lui`;
  });
}
</script>
</body>
</html>