<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>FOUDEK – Théorie et calculs</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* === STYLE EXISTANT (INCHANGÉ) === */
body {
  margin: 0;
  padding: 0;
  background: #0e0f14;
  color: #e6e7eb;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
               Roboto, Oxygen, Ubuntu, Cantarell, "Inter", sans-serif;
  line-height: 1.6;
}

.container {
  max-width: 900px;
  margin: auto;
  padding: 40px 20px;
}

h1, h2, h3 {
  text-align: center;
  font-weight: 700;
}

h1 { font-size: 30px; margin-bottom: 40px; }
h2 { font-size: 24px; margin: 50px 0 20px; }

p { margin: 16px 0; font-size: 16px; }

ul { margin: 16px 0 16px 20px; }
li { margin: 8px 0; }

.separator {
  height: 1px;
  background: #2a2c36;
  margin: 50px 0;
}

.formula {
  background: #1a1c25;
  border-radius: 8px;
  padding: 14px 18px;
  font-family: "JetBrains Mono", Consolas, monospace;
  font-size: 15px;
  margin: 20px 0;
  text-align: center;
}

/* === NOUVEAU STYLE SIMULATION === */

.board {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 20px;
  margin: 40px 0;
}

.player {
  background: #0e0f14;
  border: 1px solid #2a2c36;
  border-radius: 14px;
  padding: 14px;
  text-align: center;
  position: relative;
  transition: transform 0.4s, box-shadow 0.4s;
}

.player.you {
  border: 2px solid #22c55e;
}

.player.interval {
  box-shadow: 0 0 25px rgba(37,99,235,0.5);
  transform: scale(1.04);
}

.name {
  font-weight: 600;
}

.tag {
  font-size: 12px;
  opacity: 0.6;
}

.bubble {
  margin-top: 10px;
  padding: 6px;
  border-radius: 999px;
  font-size: 13px;
  opacity: 0;
  transition: opacity 0.5s, box-shadow 0.5s;
}

.bubble.blue { background: #1d4ed8; }
.bubble.red { background: #dc2626; }

.bubble.show {
  opacity: 1;
  box-shadow: 0 0 18px rgba(255,255,255,0.25);
}

.controls {
  text-align: center;
  margin-top: 30px;
}

.controls input {
  padding: 8px;
  width: 260px;
  background: #0e0f14;
  border: 1px solid #3a3d4d;
  color: #e6e7eb;
  border-radius: 6px;
}

.controls button {
  margin-top: 14px;
  padding: 10px 20px;
  border: none;
  border-radius: 6px;
  background: #2563eb;
  color: white;
  font-weight: bold;
  cursor: pointer;
}

.best {
  margin-top: 25px;
  text-align: center;
  padding: 10px;
  border-radius: 999px;
  background: #1a1c25;
  font-weight: bold;
}
</style>
</head>

<body>
<div class="container">

<!-- ================= CONTENU THÉORIQUE INCHANGÉ ================= -->
<!-- (exactement identique à ta version validée) -->

<h1>FOUDEK – Théorie et probabilité hors intervalle</h1>

<h2>Pourquoi il n’y a jamais plus de 1 loup sur 4</h2>

<p>
Dans la technique de FOUDEK, on considère uniquement les cas où un
intervalle de 4 joueurs contient 0 ou 1 loup.
</p>

<p>
La raison est purement probabiliste : la probabilité qu’un innocent vote
un autre innocent est plus élevée que celle de voter un loup.
</p>

<p>
Ainsi, dépasser 1/4 rend la décision irrationnelle pour un innocent.
Ces mondes sont exclus par construction.
</p>

<div class="separator"></div>

<h2>Équation universelle finale</h2>

<div class="formula">
P<sub>R</sub> =
Σ<sub>k = 0</sub><sup>1</sup>
(
C(I, k) · C(R, L − k)
/
Σ<sub>i = 0</sub><sup>1</sup>
C(I, i) · C(R, L − i)
)
× (L − k) / R
</div>

<!-- ================= NOUVELLE SIMULATION ================= -->

<div class="separator"></div>

<h2>Simulation de partie – Loup-Garou</h2>

<p>
Vous êtes un joueur innocent (« Vous »).
Les votes observés permettent de former un intervalle
et de calculer la probabilité qu’un joueur hors intervalle soit loup
selon les méthodes FOUDEK et classique.
</p>

<div class="board" id="board">
  <div class="player you"><div class="name">Vous</div><div class="tag">Innocent</div></div>
  <div class="player" data-id="A"><div class="name">Joueur A</div></div>
  <div class="player" data-id="B"><div class="name">Joueur B</div></div>
  <div class="player" data-id="C"><div class="name">Joueur C</div></div>
  <div class="player" data-id="D"><div class="name">Joueur D</div></div>
  <div class="player" data-id="E"><div class="name">Joueur E</div></div>
  <div class="player" data-id="F"><div class="name">Joueur F</div></div>
  <div class="player" data-id="G"><div class="name">Joueur G</div></div>
</div>

<div class="controls">
  <p>Votes observés (ex : A>B,C>B)</p>
  <input id="votes" placeholder="A>B,C>B">
  <br>
  <button onclick="simulate()">Lancer la simulation</button>
</div>

<div class="best" id="best">—</div>

</div>

<script>
// Combinaisons
function C(n, k) {
  if (k < 0 || k > n) return 0;
  let r = 1;
  for (let i = 1; i <= k; i++) r *= (n - i + 1) / i;
  return r;
}

function simulate() {
  const votes = document.getElementById("votes").value.split(",");
  const interval = new Set();

  document.querySelectorAll(".player").forEach(p => {
    p.classList.remove("interval");
    p.querySelectorAll(".bubble").forEach(b => b.remove());
  });

  votes.forEach(v => {
    const [a,b] = v.split(">");
    if (a && b) {
      interval.add(a.trim());
      interval.add(b.trim());
    }
  });

  interval.forEach(id => {
    const el = document.querySelector(`.player[data-id="${id}"]`);
    if (el) el.classList.add("interval");
  });

  const I = interval.size;
  const R = 7 - I;
  const L = 2;

  let num=0, den=0;
  for (let k=0;k<=1;k++){
    if (k>L||L-k>R) continue;
    const c=C(I,k)*C(R,L-k);
    den+=c;
    num+=c*((L-k)/R);
  }

  const pF = (num/den)*100;
  const pC = (L/7)*100;

  document.querySelectorAll(".player:not(.interval):not(.you)").forEach(p=>{
    const b1=document.createElement("div");
    b1.className="bubble blue show";
    b1.textContent="FOUDEK : "+pF.toFixed(1)+" %";

    const b2=document.createElement("div");
    b2.className="bubble red show";
    b2.textContent="Classique : "+pC.toFixed(1)+" %";

    p.appendChild(b1);
    p.appendChild(b2);
  });

  best.textContent =
    pF > pC
    ? "Système le plus rentable : FOUDEK"
    : "Système le plus rentable : Classique";
}
</script>

</body>
</html>